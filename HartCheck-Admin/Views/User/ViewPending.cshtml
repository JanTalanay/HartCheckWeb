@using HartCheck_Admin.Models
@model IEnumerable<User>
@{
    ViewData["Title"] = "Pending Doctors";
}
<h1 >@ViewData["Title"]</h1>

<div class="album py-5 bg-body-tertiary">
    <div class="row row-cols-1 row-cols-sm-5 row-cols-md-3 g-3" >
            @if (Model != null)
            {
                @foreach(var item in Model)
                {
                    <div class="card shadow-sm w-100">

                        @if (item.role == 1)
                        {
                            <div class="card-body">
                                <p class="card-text">@item.firstName</p>
                                <p class="card-text">@item.lastName</p>
                                <p class="card-text">@item.email</p>
                                <p class="card-text">@item.birthdate</p>
                                <p class="card-text">@item.phoneNumber</p>
                                <p class="card-text">@item.role</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">  
                                        <a asp-controller="User" asp-action="Approve" asp-route-id="@item.usersID" data-user-id="@item.usersID" id="approve-button" class="btn btn-sm btn-outline-success">Approve</a>
                                        <a asp-controller="User" asp-action="Decline" asp-route-id="@item.usersID" class="btn btn-sm btn-outline-danger">Decline</a>
                                        <a asp-controller="User" asp-action="Delete" asp-route-id="@item.usersID" class="btn btn-sm btn-outline-secondary">Delete</a>
                                    </div>
                                </div>
                            </div>
                        }
                      
                    </div>      
                }
            } 
    </div>
</div>

<div class="button-box col-lg-12 btn-group">
     <a asp-controller="User" asp-action="ViewApproved" class="btn btn-outline-info button-link"   > View Approved </a>
     <a asp-controller="User" asp-action="ViewPending" class="btn btn-outline-info button-link"   > View Pending </a>
     <a asp-controller="User" asp-action="ViewDenied" class="btn btn-outline-danger button-link"   >View Denied</a>
</div>

<script>
     $(document).ready(function () {
        $(".approve-button").click(function () {
            var usersID = $(this).data("data-user-id"); // Get the user's ID from a data attribute
            $.ajax({
                url: "@Url.Action("ApproveDoctor", "User")",
                type: "POST",
                data: { usersID: usersID },
                success: function () {
                    // Reload the page or update the UI to reflect the change
                    location.reload();
                } 
            });
        });
    });
</script>